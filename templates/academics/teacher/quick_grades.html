{% extends 'base.html' %}
{% load static %}

{% block title %}Registro de Notas - Institución Educativa La Balsa{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/labalsa_styles.css' %}">
{% endblock %}

{% block content %}
<div class="container">
    <!-- Header -->
    <div class="school-header text-center">
        <div class="row align-items-center">
            <div class="col-md-2">
                <img src="{% static 'images/ESCUDO-IE-LA-BALSA.png' %}" alt="Escudo Institución Educativa La Balsa" 
                     class="school-shield">
            </div>
            <div class="col-md-8">
                <h3 class="mb-1">Institución Educativa La Balsa</h3>
                <h5 class="mb-0">Registro Rápido de Calificaciones</h5>
            </div>
            <div class="col-md-2">
                <a href="{% url 'academics:teacher_dashboard' %}" class="btn btn-light btn-sm">
                    <i class="fas fa-arrow-left me-1"></i>Volver
                </a>
            </div>
        </div>
    </div>

    <div class="form-container">
        <div class="card">
            <div class="card-header bg-success" style="background: linear-gradient(135deg, #3CB371, #2E8B57) !important;">
                <h5 class="mb-0" style="color: white !important; font-weight: 700 !important;">
                    <i class="fas fa-edit me-2" style="color: white !important;"></i>Configurar Actividad
                </h5>
            </div>
            <div class="card-body">
                <form method="post" novalidate>
                    {% csrf_token %}
                    
                    <div class="mb-3">
                        <label for="{{ form.course.id_for_label }}" class="form-label">
                            <i class="fas fa-chalkboard me-1"></i>Curso
                        </label>
                        {{ form.course }}
                        {% if form.course.errors %}
                            <div class="text-danger small">{{ form.course.errors.0 }}</div>
                        {% endif %}
                    </div>

                    <div class="mb-3">
                        <label for="{{ form.subject.id_for_label }}" class="form-label">
                            <i class="fas fa-book me-1"></i>Materia
                        </label>
                        {{ form.subject }}
                        {% if form.subject.errors %}
                            <div class="text-danger small">{{ form.subject.errors.0 }}</div>
                        {% endif %}
                    </div>

                    <div class="mb-3">
                        <label for="{{ form.activity_name.id_for_label }}" class="form-label">
                            <i class="fas fa-tasks me-1"></i>Nombre de la Actividad
                        </label>
                        {{ form.activity_name }}
                        {% if form.activity_name.errors %}
                            <div class="text-danger small">{{ form.activity_name.errors.0 }}</div>
                        {% endif %}
                    </div>

                    <div class="mb-3">
                        <label for="{{ form.activity_type.id_for_label }}" class="form-label">
                            <i class="fas fa-tag me-1"></i>Tipo de Actividad
                        </label>
                        {{ form.activity_type }}
                        {% if form.activity_type.errors %}
                            <div class="text-danger small">{{ form.activity_type.errors.0 }}</div>
                        {% endif %}
                    </div>

                    <div class="mb-3">
                        <label for="{{ form.date_recorded.id_for_label }}" class="form-label">
                            <i class="fas fa-calendar me-1"></i>Fecha
                        </label>
                        {{ form.date_recorded }}
                        {% if form.date_recorded.errors %}
                            <div class="text-danger small">{{ form.date_recorded.errors.0 }}</div>
                        {% endif %}
                    </div>

                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-success btn-lg"
                                style="background: linear-gradient(135deg, #3CB371, #2E8B57) !important; 
                                       border-color: #2E8B57 !important; 
                                       color: white !important; 
                                       font-weight: 700 !important;
                                       text-shadow: 0 1px 2px rgba(0,0,0,0.3) !important;">
                            <i class="fas fa-arrow-right me-2" style="color: white !important;"></i>Continuar con Lista de Estudiantes
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Información adicional -->
        <div class="card mt-4">
            <div class="card-body bg-light">
                <h6 class="text-muted">
                    <i class="fas fa-info-circle me-2"></i>Información sobre Calificaciones
                </h6>
                <ul class="list-unstyled mb-0 text-muted small">
                    <li><i class="fas fa-check me-2 text-success"></i>Las calificaciones van de 1.0 a 5.0</li>
                    <li><i class="fas fa-check me-2 text-success"></i>Solo aparecerán los cursos donde usted enseña</li>
                    <li><i class="fas fa-check me-2 text-success"></i>Puede usar decimales (ej: 4.5, 3.8)</li>
                    <li><i class="fas fa-check me-2 text-success"></i>Las notas se guardan por período académico</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Auto-actualizar materias según el curso seleccionado
    document.getElementById('id_course').addEventListener('change', function() {
        const courseId = this.value;
        const subjectSelect = document.getElementById('id_subject');
        
        if (courseId) {
            subjectSelect.disabled = false;
        } else {
            subjectSelect.disabled = true;
            subjectSelect.selectedIndex = 0;
        }
    });

    // Establecer fecha actual si no hay valor
    const dateInput = document.getElementById('id_date_recorded');
    if (!dateInput.value) {
        const today = new Date().toISOString().split('T')[0];
        dateInput.value = today;
    }
</script>
{% endblock %}